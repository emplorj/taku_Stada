<!DOCTYPE html>
<html lang="ja">

<head>
    <meta name="robots" content="noindex">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>卓スタダ</title>
    <!-- OGP (Open Graph Protocol) / Twitter Card -->
    <meta property="og:title" content="卓スタダ" />
    <meta property="og:description" content="卓スタダ公式サイトです。エンJが頑張りました。" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://emplorj.github.io/taku_Stada/" />
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="stylesheet" href="css/featured-character.css">
    <!-- ★追加: 高性能CSVパーサー -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
</head>

<body>
    <div id="header-placeholder"></div>
    <canvas id="particleCanvas"></canvas>

    <div class="main-content">
        <header class="main-header">
            <h1>卓スタダ</h1>
            <p class="subtitle">いままでの犯行</p>
        </header>

        <div class="logo-container">
            <img src="img/卓スタダロゴ.png" alt="卓スタダロゴ" class="logo-image" id="main-logo">
            <img src="img/卓スタダminiロゴ.png" alt="卓スタダミニロゴ" class="logo-image mini" id="mini-logo">
        </div>

        <h2 id="coc-qa-section" class="section-title start-title"><a href="CoC_Q&A.html">✨ クトゥルフ神話TRPG シナリオスタダ</a></h2>
        <div class="plain-text-block intro-block">
            <p>クトゥルフ神話TRPGシナリオ作成に悩むあなたへ、<a href="https://twitter.com/haisuikan_trpg" target="_blank"
                    class="plain-text-author-link"
                    rel="noopener noreferrer">はいすいかん(@haisuikan_trpg)</a>さんからのアドバイスをまとめました。</p>
            <p>「どんな神話生物を使えばいいの？」「ストーリーの組み立て方が分からない！」といった疑問を解決し、自作シナリオを回そう！</p>
            <ul class="tool-card-list" id="coc-qa-links-container">
            </ul>
        </div>

        <h2 id="schedule-section" class="section-title start-title"><a href="schedule.html">📅 予定</a></h2>
        <div class="plain-text-block intro-block">
            <p>今後のセッション予定などを確認できます。</p>
            <ul class="tool-card-list" id="schedule-links-container">
            </ul>
        </div>
        <section id="featured-adventurers" class="content-section">
            <h2 class="start-title"><i class="fa-solid fa-star"></i> いろんなキャラ</h2>
            <div class="plain-text-block intro-block">
                <p>ここで登場したいろんなキャラを見てみよう！</p>
            </div>
            <div class="card-container member-list">
            </div>
        </section>

        <h2 id="slides-section" class="start-title"><a href="slides.html">📖 スライド置き場</a></h2>
        <div class="plain-text-block intro-block">
            <p>TRPGのルール説明スライドとかを雑に置いとく場所。</p>
            <p>「これどんなんだっけ？」って時にでも見てね</p>
            <ul class="link-list">
                <li><a href="https://docs.google.com/presentation/d/e/2PACX-1vSOxfzmGJTdTEXXiXOHIxlueVIfbG9Xuq8NSrv0wrgwLUHV84OfLRcyU-I0WjLSXYFfMJEfcubHJ9KR/pub?start=false&loop=true&delayms=3000"
                        target="_blank" rel="noopener noreferrer">はじめよう　クトゥルフ神話RPG</a></li>
                <li><a href="https://docs.google.com/presentation/d/e/2PACX-1vTkciQV57Bo7Jzgk85SmrG9JJPMXjaGHYweGxTQhWbeWzD5bKzkcvzBeFQXn1EHwRdM7mHVGpoeI3g4/pub?start=false&loop=false&delayms=3000"
                        target="_blank" rel="noopener noreferrer">はじめよう　ソード・ワールド2.5</a></li>
                <li><a href="https://docs.google.com/presentation/d/e/2PACX-1vRwmLeSj3YfrpHtB158EME-vQ1LbzuB3cnVfqAmJkAvcvqvv84Yk7U8dGk8Cjw79WVL7ixOETUosDXU/pub?start=false&loop=false&delayms=3000"
                        target="_blank" rel="noopener noreferrer">はじめよう ダブルクロス3rd</a></li>
                <li><a href="https://docs.google.com/presentation/d/e/2PACX-1vTTJMqZnvl2aLEbSvDq0lGRIQWkYAL2KsMgworFsdvdzo9KcAiKJtoyhU2Mt6SFZsuZfV7-rMHcd0_U/pub?start=false&loop=false&delayms=3000"
                        target="_blank" rel="noopener noreferrer">はじめよう ネクロニカ</a></li>
            </ul>
        </div>

        <h2 id="archive-section" class="start-title">アーカイブ</h2>
        <div class="plain-text-block intro-block">
            <ul class="tool-card-list" id="archive-links-container">
            </ul>
        </div>

        <h2 id="char-qa-sheet-section" class="start-title">あなたのキャラへの質問一覧シート</h2>
        <div class="plain-text-block intro-block">
            <ul>
                <li><a href="q_and_a.html">キャラクターQ&Aページ</a>: ここでキャラクターの回答を閲覧・新規登録できます。</li>
                <li><a href="https://docs.google.com/spreadsheets/d/1RJrUdz6QbYc_N1X0gub8zdixEIy_8KyV3exf6A9Smoc/edit?gid=0"
                        target="_blank" rel="noopener noreferrer">Googleスプレッドシート（元データ）</a>: キャラクターへの理解を深めるための質問集です。</li>
            </ul>
        </div>

        <h2 id="ccfolia-tools-section" class="start-title">ツール</h2>
        <div class="plain-text-block intro-block">
            <ul class="tool-card-list" id="tool-card-list-container">
            </ul>
        </div>

        <h2 id="content-policy-section" class="start-title">地雷チェックシート</h2>
        <div class="plain-text-block intro-block">
            <ul class="tool-card-list" id="content-policy-container">
            </ul>
        </div>

        <h2 id="color-codes-section" class="start-title">スタダのキャラ紹介とかで、共通規格として用いているTRPGシステムと色の組み合わせ</h2>
        <div class="plain-text-block intro-block">
            <ul class="color-code-list" id="trpg-color-list"></ul>
            <p>Q.普通の青って使わないん？<br>A. その他が青になりがち。</p>
        </div>

        <h2 id="yutosheet-template-section" class="start-title"><a href="https://yutorize.2-d.jp/" target="_blank"
                rel="noopener noreferrer">ゆとシート</a>用パーソナル情報テンプレ
        </h2>
        <div class="plain-text-block intro-block">
            <p>お手持ちのゆとシートの「容姿・経歴」とか「その他」とかの枠にでも付け加えてもらえると助かります<br>
                入れたい情報に沿って、同じ形式で情報を追加してってください（好きなものとか、弱点とか！）</p>
            <div class="code-block-container">
                <pre class="code-block" id="yutosheet-template"><code>[>]**パーソナルデータ
:性別|
:身長|
:体重|
:年齢|
: 髪 |
: 瞳 |
: 肌 |
[---]</code></pre>
                <button class="copy-button" onclick="copyCodeToClipboard('yutosheet-template')">コピー</button>
            </div>
        </div>

        <footer>
            <p>© 2025 卓スタダ.</p>
        </footer>
    </div>

    <button onclick="topFunction()" id="backToTopBtn" title="トップへ戻る">▲</button>
    <script src="js/common.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            // --- 色リスト生成 ---
            const colorListContainer = document.getElementById("trpg-color-list");
            if (colorListContainer) {
                const systemsToShow = [
                    {
                        displayName: "クトゥルフ神話TRPG",
                        colorNameDesc: "緑",
                        cssVar: "--color-coc",
                    },
                    {
                        displayName: "クトゥルフ神話TRPG(秘匿)",
                        colorNameDesc: "濃緑",
                        cssVar: "--color-coc-secret",
                    },
                    {
                        displayName: "ソード・ワールド2.5",
                        colorNameDesc: "薄赤",
                        cssVar: "--color-sw",
                    },
                    {
                        displayName: "ダブルクロス The 3rd Edition",
                        colorNameDesc: "赤",
                        cssVar: "--color-dx3",
                    },
                    {
                        displayName: "永い後日談のネクロニカ",
                        colorNameDesc: "灰",
                        cssVar: "--color-nechronica",
                    },
                    {
                        displayName: "サタスペ",
                        colorNameDesc: "オレンジ",
                        cssVar: "--color-satasupe",
                    },
                    {
                        displayName: "マモノスクランブル",
                        colorNameDesc: "黄橙",
                        cssVar: "--color-mamoburu",
                    },
                    {
                        displayName: "銀剣のステラナイツ",
                        colorNameDesc: "暗い青",
                        cssVar: "--color-stellar",
                    },
                    {
                        displayName: "ウマ娘TRPG",
                        colorNameDesc: "桃",
                        cssVar: "--color-umamusume",
                    },
                    {
                        displayName: "シノビガミ",
                        colorNameDesc: "紫",
                        cssVar: "--color-shinobigami",
                    },
                    {
                        displayName: "アリアンロッドRPG 2E",
                        colorNameDesc: "黄色",
                        cssVar: "--color-ar",
                    },
                ];
                systemsToShow.forEach((sys) => {
                    const style = getComputedStyle(document.documentElement);
                    const colorCode =
                        style.getPropertyValue(sys.cssVar).trim() ||
                        style.getPropertyValue("--color-default").trim();
                    const listItem = document.createElement("li");
                    listItem.classList.add("color-list-item");
                    listItem.innerHTML = `<span class="color-list-text">${sys.displayName}：（${sys.colorNameDesc}）</span> <span class="color-chip" style="background-color: ${colorCode};"></span> <code>${colorCode}</code> <button class="copy-color-button" data-colorcode="${colorCode}" title="カラーコードをコピー">コピー</button>`;
                    colorListContainer.appendChild(listItem);
                });
                colorListContainer.addEventListener("click", function (event) {
                    const button = event.target.closest(".copy-color-button");
                    if (button) {
                        navigator.clipboard.writeText(button.dataset.colorcode).then(() => {
                            const originalText = button.textContent;
                            button.textContent = "OK!";
                            button.disabled = true;
                            setTimeout(() => {
                                button.textContent = originalText;
                                button.disabled = false;
                            }, 1500);
                        });
                    }
                });
            }

            // --- ロゴクリックイベント ---
            const mainLogo = document.getElementById("main-logo");
            const miniLogo = document.getElementById("mini-logo");

            if (mainLogo) {
                mainLogo.addEventListener("click", function () {
                    window.location.href = "sutada_chara.html";
                });
            }

            if (miniLogo) {
                miniLogo.addEventListener("click", function () {
                    window.location.href = "sutada_chara.html#coc-mini-section"; // miniCoCのセクションIDに合わせる
                });
            }

            // --- OGPカードリスト生成 ---
            const toolData = [
                {
                    category: "試し振りなど",
                    url: "https://ccfolia.com/rooms/6584j5uuj",
                    title: "楽屋ココフォリア",
                    author: "おれ・ココフォリア",
                    manual: true,
                    description: "ココフォリアの公式ルームです。",
                    icon: "fa-solid fa-dice-d20",
                },
                {
                    category: "キャラクターシート",
                    url: "https://kurian.websozai.jp/charaPiece/top",
                    title: "キャラシコピペツール (CoC, SW等)",
                    author: "@Kuuriku_Sora",
                    manual: true,
                    description: "各種キャラクターシートをココフォリア用に整形します。",
                    icon: "fa-solid fa-paste",
                },
                {
                    category: "キャラクターシート",
                    url: "https://script.google.com/macros/s/AKfycbwUPjuiBEGUrfrKcKZCrRAqiB7V687tbA5uxy7PbKxSkgMGnoIMob7yK0PNEvBoUcbTTA/exec",
                    title: "キャラシコピペツール (DX3rd, サタスペ等)",
                    author: "おれ",
                    manual: true,
                    description: "Google Apps Script製のキャラクターシート整形ツール。",
                    icon: "fa-solid fa-file-lines",
                },
                {
                    category: "キャラクターシート",
                    url: "https://docs.google.com/spreadsheets/d/1jMnjoqxiJZanm6L9-HsXw1crxBdQB_SZQgM4O8Tk7MM/",
                    title: "ダブルクロス コンボジェネレーター",
                    author: "おれ",
                    manual: true,
                    description: "Googleスプレッドシート上で動作するコンボビルダー。",
                    icon: "fa-solid fa-table-cells",
                },
                {
                    category: "キャラクターシート",
                    url: "https://docs.google.com/presentation/d/1ZHHNs_yR37joGYSBiYfQ_C_mwmhdFNHmxkA7fItBkKs/edit#slide=id.g2710a927f4d_0_5",
                    title: "ダブルクロス コンボジェネレーター (説明)",
                    author: "おれ",
                    manual: true,
                    description: "コンボジェネレーターの使い方を解説したスライド。",
                    icon: "fa-solid fa-person-chalkboard",
                },
                {
                    category: "ログ・テキスト整形",
                    url: "https://sirubedon.github.io/ccfolia-log-to-xlsx/",
                    title: "ココフォリアログ→Excel変換",
                    author: "しるべ",
                    manual: true,
                    description: "ココフォリアのログをExcel形式に変換します。",
                    icon: "fa-solid fa-file-excel",
                },
                {
                    category: "ログ・テキスト整形",
                    url: "https://sirubedon.github.io/CCfoliaLogConverterWithImages/",
                    title: "ココフォリア/Tekeyログ整形 (画像埋込)",
                    author: "しるべ",
                    manual: true,
                    description: "ログに画像サムネイルを埋め込んで整形します。",
                    icon: "fa-solid fa-image",
                },
                {
                    category: "立ち絵",
                    url: "https://x.com/qxoiUioxp/status/1898323502731796480",
                    title: "動画→動く画像(APNG)変換",
                    author: "しるべ",
                    manual: true,
                    description: "動画ファイルをAPNG形式にオンラインで変換します。",
                    icon: "fa-solid fa-film",
                },
                {
                    category: "アフタープレイ",
                    url: "https://x.com/qxoiUioxp/status/1937703792004440501",
                    title: "卓報告ジェネレーター",
                    author: "しるべ vs ダスト",
                    manual: true,
                    description: "SNSで報告するためのテンプレを作ります。",
                    icon: "fa-brands fa-twitter",
                },
            ];

            const toolCardContainer = document.getElementById("tool-card-list-container");

            if (toolCardContainer) {
                const groupedByCategory = toolData.reduce((acc, tool) => {
                    const category = tool.category || "その他";
                    if (!acc[category]) acc[category] = [];
                    acc[category].push(tool);
                    return acc;
                }, {});

                for (const category in groupedByCategory) {
                    const categoryHeader = document.createElement("h3");
                    categoryHeader.className = "tool-author-header"; // Re-use style
                    categoryHeader.textContent = category;
                    toolCardContainer.appendChild(categoryHeader);

                    const categoryToolList = document.createElement("ul");
                    categoryToolList.className = "tool-card-list";

                    groupedByCategory[category].forEach((tool) => {
                        const wrapper = document.createElement("li");
                        wrapper.className = "ogp-card-wrapper";

                        const cardPlaceholder = document.createElement("div");

                        if (tool.manual) {
                            renderManualCard(tool, cardPlaceholder);
                        } else {
                            cardPlaceholder.className = "ogp-card";
                            cardPlaceholder.innerHTML = `<a href="${tool.url}" target="_blank" rel="noopener noreferrer"><div class="ogp-card-content"><p>読み込み中...</p></div></a>`;
                            fetchOgpData(tool.url, cardPlaceholder);
                        }

                        wrapper.appendChild(cardPlaceholder);
                        categoryToolList.appendChild(wrapper);
                    });
                    toolCardContainer.appendChild(categoryToolList);
                }
            }

            // --- Schedule Links Generation ---
            const scheduleData = [
                {
                    url: "https://character-sheets.appspot.com/schedule/list?key=ahVzfmNoYXJhY3Rlci1zaGVldHMtbXByHAsSEkRpc2NvcmRTZXNzaW9uRGF0YRimu5y4BQw",
                    title: "デイコード",
                    description:
                        "キャラシサイトと連携した日程調整ツール。予定の入力はこちらから。",
                    icon: "fa-solid fa-calendar-plus",
                    manual: true,
                },
            ];

            const scheduleLinksContainer = document.getElementById(
                "schedule-links-container"
            );

            if (scheduleLinksContainer) {
                scheduleData.forEach((item) => {
                    const wrapper = document.createElement("li");
                    wrapper.className = "ogp-card-wrapper";
                    const cardPlaceholder = document.createElement("div");
                    renderManualCard(item, cardPlaceholder);
                    wrapper.appendChild(cardPlaceholder);
                    scheduleLinksContainer.appendChild(wrapper);
                });
            }

            // --- Archive Links Generation ---
            const archiveData = [
                {
                    url: "https://docs.google.com/spreadsheets/d/17wStGJ37GjaINrjZMFZgmacYOPeH9F8ZiahhtJd_nxI/",
                    title: "スプレッドシート",
                    description:
                        "卓の履歴や、キャラのまとめ、PLの所持ルールブックなんかをここに記す",
                    icon: "img/spreadsheet.svg",
                    manual: true,
                },
                {
                    url: "https://www.dropbox.com/scl/fo/lnuvslrnsqqyye3ka3dfa/APfMlkTTNNrt9Lgnx5sOOVA?rlkey=t5ltutxf80yqz8p499dae7loj&dl=0",
                    title: "ログ置き場（Dropbox）",
                    description:
                        "終わったシナリオのログが一元的にみられたらいいねってところ。(Discord: 該当チャンネル)",
                    icon: "fa-brands fa-dropbox",
                    manual: true,
                },
            ];

            const archiveLinksContainer = document.getElementById(
                "archive-links-container"
            );

            if (archiveLinksContainer) {
                archiveData.forEach((item) => {
                    const wrapper = document.createElement("li");
                    wrapper.className = "ogp-card-wrapper";
                    const cardPlaceholder = document.createElement("div");
                    renderManualCard(item, cardPlaceholder); // Use renderManualCard for these
                    wrapper.appendChild(cardPlaceholder);
                    archiveLinksContainer.appendChild(wrapper);
                });
            }

            // --- Content Policy Link Generation ---
            const contentPolicyData = [
                {
                    url: "https://booth.pm/ja/items/3432975",
                    title: "細かすぎる地雷チェックシート",
                    description:
                        "セッション前に参加者間の認識を合わせるため、弊社では規定のものとして下記シートの使用を推奨しています。",
                    icon: "fa-solid fa-file-shield",
                    manual: true,
                },
            ];

            const contentPolicyContainer = document.getElementById(
                "content-policy-container"
            );

            if (contentPolicyContainer) {
                contentPolicyData.forEach((item) => {
                    const wrapper = document.createElement("li");
                    wrapper.className = "ogp-card-wrapper";
                    const cardPlaceholder = document.createElement("div");
                    renderManualCard(item, cardPlaceholder);
                    wrapper.appendChild(cardPlaceholder);
                    contentPolicyContainer.appendChild(wrapper);
                });
            }

            // --- CoC Q&A Links Generation ---
            const cocQaData = [
                {
                    url: "https://docs.google.com/spreadsheets/d/1MifivHkro_g2S_9QFYJoCa4eBaSNw-JqoEexGCEr41w/edit?usp=sharing",
                    title: "シナリオテンプレ／CoC",
                    description:
                        "クトゥルフ神話TRPGのシナリオ作成用テンプレート。（作：あばれぢから）",
                    icon: "fa-solid fa-file-pen",
                    manual: true,
                },
                {
                    url: "https://docs.google.com/spreadsheets/d/1W5Hhm-GpknEec8vKPIqxfWGl8JADwY5Dj_3b33m45aA/",
                    title: "シナリオテンプレ／DX3rd",
                    description: "ダブルクロス3rdのシナリオ作成用テンプレート。",
                    icon: "fa-solid fa-file-pen",
                    manual: true,
                },
            ];

            const cocQaLinksContainer = document.getElementById("coc-qa-links-container");

            if (cocQaLinksContainer) {
                cocQaData.forEach((item) => {
                    const wrapper = document.createElement("li");
                    wrapper.className = "ogp-card-wrapper";
                    const cardPlaceholder = document.createElement("div");
                    renderManualCard(item, cardPlaceholder);
                    wrapper.appendChild(cardPlaceholder);
                    cocQaLinksContainer.appendChild(wrapper);
                });
            }
        });
    </script>
    <script src="js/featured-character.js"></script>

</body>

</html>
