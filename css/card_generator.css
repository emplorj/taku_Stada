/* card_generator.css */
html, body {
    height: 100%;
    margin: 0;
    padding: 0;
}

.main-content {
    padding: 20px !important;
    flex-grow: 1;
}
.page-card-creator {
    display: flex;
    flex-direction: column;
    min-height: 100vh;
    overflow-y: auto;
}
.page-header-with-actions .subtitle { font-family: 'Makinas-4-Flat', sans-serif; }
.creator-container {
    display: flex;
    gap: 20px;
    max-width: 1400px;
    margin: 0 auto;
    align-items: flex-start;
    justify-content: center;
}
.controls-panel { min-width: 320px; max-width: 900px; flex-shrink: 1; flex-grow: 1; background-color: var(--controls-panel-bg, #1a2c6d); overflow-y: auto; padding: 20px 25px; border-radius: 8px; transition: background-color 0.3s; }
.form-group-inline { display: flex; gap: 15px; align-items: center; }
.form-group-item { flex: 1; }
.controls-panel label { font-weight: bold; text-shadow: 0 0 3px rgba(173, 216, 230, 0.5); }
.color-description { font-weight: normal; font-size: 0.9em; color: #bdc3c7; }
.controls-panel input, .controls-panel textarea, .controls-panel select { width: 100%; box-sizing: border-box; background-color: var(--theme-input-bg, #0d1a50); color: #eee; border: 1px solid var(--theme-input-border, #2a3c7d); border-radius: 4px; padding: 10px; font-size: 1em; font-family: inherit; transition: border-color 0.2s, box-shadow 0.2s, background-color 0.3s; }
.controls-panel input:focus, .controls-panel textarea:focus, .controls-panel select:focus { border-color: #3498db; box-shadow: 0 0 8px rgba(52, 152, 219, 0.5); outline: none; }
.controls-panel textarea { resize: vertical; min-height: 80px; }
.preview-wrapper {
    flex-shrink: 0;
    min-width: 0;
}

.preview-panel {
    width: 480px;
    height: 720px;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    transform-origin: top left;
}
.download-options { display: flex; align-items: center; gap: 15px; flex-wrap: wrap; justify-content: center; width: 100%; }
.download-options .add-new-button { flex-grow: 1; padding: 12px 15px; }
.download-options .secondary-button { flex-grow: 1; }
.checkbox-container { display: flex; align-items: center; gap: 5px; color: #b0c4de; white-space: nowrap; }
.checkbox-container label { cursor: pointer; }
#preview-area { width: 480px; height: 720px; }
#card-container { position: relative; width: 100%; height: 100%; color: #000; user-select: none; }
#card-container > img { position: absolute; top: 0; left: 0; pointer-events: none; }

#card-template-image { width: 100%; height: 100%; z-index: 3; }
#background-image { width: 100%; height: 100%; object-fit: cover; z-index: 0; }
#sparkle-overlay-image {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    z-index: 5;
    mix-blend-mode: lighten;
    pointer-events: none;
}
.card-text {
    z-index: 30;
    position: absolute;
    box-sizing: border-box;
    text-align: center;
    color: #000;
    white-space: pre-wrap;
    word-wrap: break-word;
    pointer-events: none;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    font-smooth: always;
}
#overlay-image-container {
    position: absolute;
    top: 0;
    left: 0;
    width: 480px;
    height: 720px;
    z-index: 20;
    overflow: hidden;
    pointer-events: none;
}
#overlay-image {
    position: absolute;
    transform-origin: center;
    pointer-events: none;
}
#card-name-container {
    position: absolute;
    top: 46px;
    left: 50%;
    transform: translateX(-50%);
    width: 392px;
    height: 56px;
    background-image: url('../Card_asset/タイトル.png');
    background-position: center;
    background-repeat: no-repeat;
    z-index: 10;
    display: flex;
    justify-content: center;
    align-items: center;
}
#card-name-content {
    position: relative;
    font-family: 'RocknRoll One', sans-serif;
    font-size: 28px;
    white-space: nowrap;
    transform-origin: center;
    color: #000;
    line-height: 1;
    max-width: 334px;
    text-align: center;
}

#card-name-content .scaler {
    display: inline-block;
    transform-origin: center;
    white-space: nowrap;
    font-family: 'RocknRoll One', sans-serif;
    font-size: 28px;
    color: #000;
    line-height: 1;
}
#card-name-content .no-ruby {
    padding-top: 0;
    position: relative;
    top: -3px;
}
#card-name-content ruby {
    display: inline-block;
    vertical-align: baseline;
    position: relative;
}
#card-name-content rb {
    display: inline-block;
    padding-top: 14px;
    line-height: 1;
    position: relative;
    top: -3px;
}
#card-name-content rt {
    position: absolute;
    top: -1px;
    left: 50%;
    transform: translateX(calc(-50% + 1px));
    font-size: 14px;
    line-height: 1;
    white-space: nowrap;
}

#card-name-content.is-plain-text-only .no-ruby {
    top: 1px;
}

.title-styled {
    -webkit-text-stroke: 2px white;
    text-stroke: 2px white;
    paint-order: stroke fill;
    text-shadow: none;
}

.textbox-styled .card-text {
  color: #000;
  text-shadow:
    1px 0 0 white, -1px 0 0 white, 0 1px 0 white, 0 -1px 0 white,
    1px 1px 0 white, -1px -1px 0 white, 1px -1px 0 white, -1px 1px 0 white,
    2px 2px 4px rgba(0, 0, 0, 0.5);
  -webkit-text-stroke: 0;
  text-stroke: 0;
  paint-order: normal;
}
.char-kern {
    letter-spacing: 0.04em; /* アルファベット、数字、ハイフンの文字間を広げる */
}

.paren-fix {
    letter-spacing: -0.05em; /* 括弧の文字間を狭める */
}
/* =================================================== */
/* ★★★ ここからがレイアウトの最終修正箇所です ★★★ */
/* =================================================== */

/* テキストボックス全体 */
#text-box-container {
    position: absolute;
    left: 44px;
    top: 520px;
    width: 392px;
    height: 177.5px;
    overflow: visible; /* ★重要：子要素がはみ出すことを許可する */
    z-index: 31;       /* ★重要：画像コンテナより手前に表示させる */
}

/* 効果・説明欄（変更なし） */
#effect-display {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    overflow: hidden;
    padding: 0 16px;
    box-sizing: border-box;
    font-size: 20px;
    font-family: "nitalago-ruika", sans-serif;
    font-weight: 100;
    line-height: 1.25;
    text-align: left;
    font-feature-settings: "palt";
}

/* フレーバーテキスト欄 */
#flavor-display {
    position: absolute;
    bottom: 25px; /* 話者の上に配置 */
    left: 0;
    width: 100%;
    /* max-height と overflow を削除し、コンテンツ自身の高さに任せる */
    padding: 0 28px;
    box-sizing: border-box;
    font-size: 16px;
    font-family: "Klee One";
    font-weight: bold;
    line-height: 1.2;
    text-align: left;
    letter-spacing: 0.05em;
    font-feature-settings: "palt";
}

/* フレーバー話者欄（変更なし） */
#flavor-speaker-display {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 25px;
    padding: 0 21px;
    box-sizing: border-box;
    text-align: right;
    font-size: 16px;
    font-family: "Klee One";
    font-weight: bold;
    line-height: 1;
    white-space: nowrap;
}

/* 内部のテキストラッパー */
#flavor-display > .inner-text {
    width: 100%;
    word-break: break-word;
    overflow-wrap: break-word;
}

#image-container { position: absolute; top: 0; left: 0; width: 480px; height: 480px; z-index: 1; overflow: hidden; cursor: default; transition: height 0.3s ease; }
#card-image { position: absolute; transform-origin: center; }
.image-upload-controls { display: flex; gap: 10px; align-items: center; }
.file-name-display { flex-grow: 1; background-color: var(--theme-input-bg, #0d1a50); color: #bdc3c7; padding: 8px 12px; border-radius: 4px; font-size: 0.9em; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; border: 1px solid var(--theme-input-border, #2a3c7d); transition: background-color 0.3s, border-color 0.3s; }
.custom-file-upload, .secondary-button { padding: 10px 15px; border-radius: 5px; cursor: pointer; text-align: center; font-weight: bold; transition: all 0.2s ease; }
.custom-file-upload { background: var(--button-bg, #3498db); color: var(--button-color, #FFFFFF); border: none; text-shadow: 1px 1px 2px rgba(0,0,0,0.4); box-shadow: 0 2px 5px rgba(0,0,0,0.2); display: inline-flex; align-items: center; }
.custom-file-upload:hover { background: var(--button-hover-bg, #2980b9); transform: translateY(-1px); box-shadow: 0 4px 8px rgba(0,0,0,0.3); }
.secondary-button { background-color: #6c757d; color: white; border: 1px solid #5a6268; }
.secondary-button:hover { background-color: #5a6268; }
.add-new-button { margin-top: 30px; width: 100%; padding: 15px; font-size: 1.2em; font-weight: bold; color: #f0e6d2; background: linear-gradient(145deg, #1a2940, #2c3e50); border: 2px solid #c8a464; border-radius: 10px; text-shadow: 0 0 5px rgba(255, 223, 150, 0.8), 1px 1px 2px rgba(0,0,0,0.7); box-shadow: 0 0 12px rgba(173, 216, 230, 0.6), inset 0 0 6px rgba(173, 216, 230, 0.4), 0 4px 8px rgba(0,0,0,0.3); transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1); cursor: pointer; }
.add-new-button:hover { transform: translateY(-3px) scale(1.02); border-color: #f1d699; }
.add-new-button:disabled {
   opacity: 0.5;
   cursor: not-allowed;
   box-shadow: none;
   text-shadow: none;
   transform: none;
   border-color: #5a6268;
   background: #333;
   color: #aaa;
}

.batch-processing-details > summary {
    cursor: pointer;
    list-style: none;
}
.batch-processing-details > summary::-webkit-details-marker {
    display: none;
}
.batch-processing-details > summary > h2 {
    display: inline-block;
    color: #c8a464;
    margin-bottom: 0;
    line-height: 1.5;
}
.batch-processing-details > summary > h2::before {
    content: '▶';
    color: #c8a464;
    font-size: 0.9em;
    transition: transform 0.2s ease-in-out;
    display: inline-block;
    margin-right: 10px;
    vertical-align: middle;
}
.batch-processing-details[open] > summary > h2::before {
    transform: rotate(90deg);
}
.batch-processing-details[open] > summary {
    margin-bottom: 15px;
}
.batch-processing-section {
    margin-top: 0;
    padding-top: 10px;
    border-top: none;
}
.batch-processing-details > summary:focus-visible {
    outline: 2px solid var(--button-bg, #3498db);
    outline-offset: 4px;
    border-radius: 4px;
}

@media (max-width: 1360px) {
    .creator-container { flex-direction: column; align-items: center; }
    .controls-panel, .preview-wrapper {
        width: 100%;
        max-width: 480px;
        min-width: unset;
    }
    .preview-wrapper {
        margin-top: 20px;
    }
}

@media (max-width: 479px) {
    .preview-wrapper {
        width: 100%;
        overflow: hidden;
        margin-top: 20px;
    }
    #preview-area {
        transform-origin: top left;
    }
}

.light-theme-ui .controls-panel {
    background-color: var(--controls-panel-bg, #ecf0f1); /* ライトテーマ時のcontrols-panel背景色 */
}
.light-theme-ui .controls-panel label { color: #2c3e50; text-shadow: none; }
.light-theme-ui .color-description { color: #34495e; }
.light-theme-ui .controls-panel input, .light-theme-ui .controls-panel textarea, .light-theme-ui .controls-panel select {
    color: #2c3e50;
    background-color: var(--theme-input-bg, #ffffff); /* ライトテーマ時の入力フィールド背景色 */
    border-color: var(--theme-input-border, #bdc3c7); /* ライトテーマ時の入力フィールドボーダー色 */
}
.light-theme-ui .file-name-display {
    color: #34495e;
    background-color: var(--theme-input-bg, #ffffff); /* ライトテーマ時のファイル名表示背景色 */
    border-color: var(--theme-input-border, #bdc3c7); /* ライトテーマ時のファイル名表示ボーダー色 */
}

.light-theme-ui .font-spec-details summary,
.light-theme-ui .font-spec-table th,
.light-theme-ui .font-spec-table td {
    color: #2c3e50;
}

::selection {
  background-color: #c8a464;
  color: #1a2940;
  text-shadow: none;
}

.font-spec-details {
    max-width: 1400px;
    margin: 0 auto 20px;
    padding: 0 20px;
}
.font-spec-details summary {
    cursor: pointer;
    font-weight: bold;
    color: #b0c4de;
    margin-bottom: 10px;
    outline: none;
    list-style: none;
    text-align: center;
}
.font-spec-details summary::-webkit-details-marker {
    display: none;
}
.font-spec-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.9em;
    background-color: var(--theme-bg-main, #1a2c6d);
    overflow: hidden;
    max-height: 1000px;
    opacity: 1;
}
.font-spec-table th, .font-spec-table td {
    border: 1px solid var(--theme-border, #2a3c7d);
    padding: 8px 12px;
    text-align: left;
    color: #bdc3c7;
}
.font-spec-table th {
    background-color: var(--theme-bg-dark, #0d1a50);
}

.batch-processing-section {
    border-top: 1px solid var(--theme-border, #2a3c7d);
}
.batch-processing-section h2 {
    color: #c8a464;
    margin-bottom: 15px;
}
.progress-display {
    margin-top: 10px;
    font-size: 0.9em;
    color: #bdc3c7;
}

.batch-spec-details {
    margin-top: 15px;
}
.batch-spec-details summary {
    cursor: pointer;
    font-weight: bold;
    color: #b0c4de;
    outline: none;
}
.batch-spec-details .spec-content {
    margin-top: 10px;
    padding: 15px;
    background-color: var(--theme-bg-dark, #0d1a50);
    border-radius: 6px;
    border: 1px solid var(--theme-border, #2a3c7d);
    font-size: 0.9em;
    color: #bdc3c7;
}
.batch-spec-details pre {
    background-color: rgba(0,0,0,0.2);
    padding: 10px;
    border-radius: 4px;
    white-space: pre-wrap;
    word-wrap: break-word;
}
.batch-spec-details .note {
    font-size: 0.85em;
    color: #95a5a6;
    margin-top: 10px;
}
.light-theme-ui .batch-spec-details summary { color: #2c3e50; }
.light-theme-ui .batch-spec-details .spec-content { color: #34495e; }
.light-theme-ui .batch-spec-details .note { color: #7f8c8d; }

.toggle-switch-container {
    display: flex;
    width: 100%;
    border-radius: 6px;
    overflow: hidden;
    border: 1px solid var(--theme-border, #2a3c7d);
}
.toggle-switch-container input[type="radio"] {
    display: none;
}
.toggle-switch-container label {
    flex-grow: 1;
    padding: 10px 15px;
    text-align: center;
    font-weight: bold;
    cursor: pointer;
    color: #bdc3c7;
    background-color: var(--theme-input-bg, #0d1a50);
    transition: background-color 0.2s ease, color 0.2s ease;
    user-select: none;
}
.toggle-switch-container input[type="radio"]:checked + label {
    color: var(--button-color, #FFFFFF);
    background-color: var(--button-bg, #3498db);
    text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
}
.toggle-switch-container input[type="radio"]:not(:checked) + label:hover {
    background-color: var(--controls-panel-bg, #1a2c6d);
}
.light-theme-ui .toggle-switch-container label {
    background-color: var(--theme-input-bg, #ecf0f1); /* ライトテーマ時のトグルスイッチ背景色 */
    color: #34495e;
}
.light-theme-ui .toggle-switch-container input[type="radio"]:checked + label {
    background-color: var(--button-bg, #3498db);
    color: var(--button-color, #FFFFFF);
}
.light-theme-ui .toggle-switch-container input[type="radio"]:not(:checked) + label:hover {
    background-color: var(--controls-panel-bg, #dfe6e9); /* ライトテーマ時のホバー色 */
}

@media (min-width: 1361px) {
  .preview-wrapper {
    position: -webkit-sticky;
    position: sticky;
    top: 20px;
  }
}

/* ===============================================
   データベース登録モーダルのスタイル
   =============================================== */

.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 1000;
    opacity: 0;
    transition: opacity 0.3s ease;
}
.modal-overlay.is-visible {
    display: flex;
    opacity: 1;
}
.modal-content {
    background-color: var(--modal-bg, #1a2c6d);
    padding: 25px 0 15px;
    border-radius: 10px;
    width: 90%;
    max-width: 800px;
    box-shadow: 0 5px 25px rgba(0,0,0,0.5);
    border: 1px solid var(--modal-border, #2a3c7d);
    transform: scale(0.95);
    transition: transform 0.3s ease;
    display: flex;
    flex-direction: column;
    max-height: 85vh;
    height: 85vh;
}
.modal-overlay.is-visible .modal-content {
    transform: scale(1);
}
.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
    color: var(--modal-header-color, #c8a464);
    flex-shrink: 0;
    padding: 0 30px;
}
.modal-header h2 {
    margin: 0;
    font-size: 1.4em;
}
.modal-close-btn {
    background: none;
    border: none;
    font-size: 2em;
    color: var(--modal-close-btn-color, #bdc3c7);
    cursor: pointer;
    line-height: 1;
    padding: 0;
}
.modal-footer {
    margin-top: 25px;
}
.modal-content .form-group label {
    font-weight: bold;
    text-shadow: 0 0 3px rgba(173, 216, 230, 0.5);
    display: block;
    margin-bottom: 5px;
    color: var(--modal-label-color, #b0c4de);
}
.modal-content .form-group input[type="text"],
.modal-content .form-group textarea {
    width: 100%;
    box-sizing: border-box;
    background-color: var(--modal-input-bg, #0d1a50);
    color: #eee;
    border: 1px solid var(--modal-input-border, #2a3c7d);
    border-radius: 4px;
    padding: 10px;
    font-size: 1em;
    font-family: inherit;
    transition: border-color 0.2s, box-shadow 0.2s, background-color 0.3s;
    margin-bottom: 15px;
}
.modal-content .form-group input[type="text"]:focus,
.modal-content .form-group textarea:focus {
    border-color: #3498db;
    box-shadow: 0 0 8px rgba(52, 152, 219, 0.5);
    outline: none;
}
.modal-content .form-group textarea {
    resize: vertical;
    min-height: 80px;
}
.modal-body {
    padding: 0 5px;
}

/* ===============================================
   タブ切り替えUIのスタイル (最終デザイン版 v2)
   =============================================== */

.tab-container {
    width: 100%;
    margin-top: 30px;
    display: flex;
    flex-wrap: wrap;
    border-bottom: 2px solid var(--theme-border, #2a3c7d);
}
.tab-switch {
    display: none;
}
.tab-label {
    flex-grow: 1;
    text-align: center;
    padding: 12px 15px;
    font-weight: bold;
    color: #bdc3c7;
    cursor: pointer;
    position: relative;
    border: 2px solid var(--theme-border, #2a3c7d);
    border-radius: 8px 8px 0 0;
    border-bottom: 2px solid transparent;
    background-color: transparent;
    transition: all 0.2s ease;
}
.tab-label:not(.tab-switch:checked + .tab-label):hover {
    color: #fff;
    background-color: rgba(44, 62, 80, 0.3);
}
.tab-switch:checked + .tab-label {
    color: #f0e6d2;
    background-color: var(--theme-bg-main, #1a2c6d);
    border-color: var(--theme-border, #2a3c7d);
    margin-bottom: -2px;
}
.tab-content {
    display: none;
    background-color: transparent;
    width: 100%;
    order: 99;
}
#tab-generator:checked ~ #generator-content,
#tab-batch:checked ~ #batch-content,
#tab-database:checked ~ #database-content,
#tab-font:checked ~ #font-content {
    display: block;
}
#tab-font:checked ~ #font-content .font-spec-table {
    max-height: 1000px;
    opacity: 1;
}

.batch-panel-container {
    max-width: 900px;
    margin: 0 auto;
    padding: 20px 25px;
    background-color: var(--controls-panel-bg, #1a2c6d);
    border-radius: 8px;
}
/* ===============================================
   データベース閲覧ページのスタイル
   =============================================== */
.database-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 20px;
    margin-top: 30px;
}
.db-card {
    background-color: var(--theme-bg-dark, #0d1a50);
    border-radius: 8px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    transition: transform 0.2s, box-shadow 0.2s;
}
.db-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 16px rgba(0,0,0,0.4);
}
.db-card-image {
    width: 100%;
    height: 200px;
    background-color: #000;
}
.db-card-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}
.db-card-info {
    padding: 15px;
    flex-grow: 1;
}
.db-card-name {
    margin: 0 0 10px 0;
    color: #f0e6d2;
    font-size: 1.2em;
    font-family: 'RocknRoll One', sans-serif; /* 追加 */
}
.db-card-meta {
    margin: 4px 0;
    font-size: 0.9em;
    color: #bdc3c7;
    font-family: "nitalago-ruika", sans-serif; /* 追加 */
}
.db-card-id {
    margin-top: 10px;
    font-size: 0.8em;
    color: #95a5a6;
    opacity: 0.9;
    font-family: 'Vermin Vibes V', sans-serif;
}
.db-card-actions {
    display: flex;
    gap: 10px;
    padding: 0 15px 15px 15px;
}
.db-card-actions .secondary-button {
    flex-grow: 1;
    margin: 0;
    padding: 8px;
}

/* ===============================================
   ライトテーマ用モーダルスタイル
   =============================================== */
.light-theme-ui .modal-content {
    background-color: var(--modal-bg, #ecf0f1);
    border-color: var(--modal-border, #bdc3c7);
}
.light-theme-ui .modal-header h2 {
    color: var(--modal-header-color, #2c3e50);
}
.light-theme-ui .modal-close-btn {
    color: var(--modal-close-btn-color, #7f8c8d);
}
.light-theme-ui .modal-content .form-group label,
.light-theme-ui .modal-content .checkbox-container label {
    color: var(--modal-label-color, #34495e);
    text-shadow: none;
}
.light-theme-ui .modal-content .form-group input[type="text"],
.light-theme-ui .modal-content .form-group textarea {
    color: #2c3e50;
    background-color: var(--modal-input-bg, #ffffff);
    border: 1px solid var(--modal-input-border, #bdc3c7);
}
.light-theme-ui .modal-content .form-group input[type="text"]:focus,
.light-theme-ui .modal-content .form-group textarea:focus {
    border-color: #3498db;
    box-shadow: 0 0 8px rgba(52, 152, 219, 0.5);
}

/* 定型文挿入ボタンのスタイル */
#open-teikei-modal-btn {
    width: 100%;
    margin-top: 5px;
}
/* 定型文モーダル用のスタイル */
.teikei-list-container {
    list-style: none;
    padding: 0 15px 0 30px;
    margin: 0;
    flex-grow: 1;
    overflow-y: auto;
    min-height: 0;
}
.teikei-list-container li {
    padding: 12px 15px;
    border-bottom: 1px solid var(--theme-border, #2a3c7d);
    cursor: pointer;
    transition: background-color 0.2s;
}
.teikei-list-container li:hover {
    background-color: var(--button-hover-bg, #2980b9);
    color: var(--button-color, #FFFFFF);
}
.teikei-list-container li:last-child {
    border-bottom: none;
}
.light-theme-ui .teikei-list-container li {
    border-bottom-color: #bdc3c7;
}
.light-theme-ui .teikei-list-container li:hover {
    background-color: #3498db;
    color: #fff;
}

/* ===============================================
   定型文モーダルのレスポンシブUIスタイル (v2)
   =============================================== */
.teikei-tab-nav {
    display: flex;
    flex-wrap: wrap;
    gap: 5px;
    border-bottom: 2px solid var(--theme-border, #2a3c7d);
    margin-bottom: 15px;
    flex-shrink: 0;
    padding: 0 30px;
}
.teikei-tab-button {
    flex-grow: 1;
    text-align: center;
    padding: 12px 10px;
    font-weight: bold;
    color: #bdc3c7;
    cursor: pointer;
    position: relative;
    border: 2px solid transparent;
    border-radius: 8px 8px 0 0;
    background-color: transparent;
    transition: all 0.2s ease;
    white-space: nowrap;
}
.teikei-tab-button:hover:not(.active) {
    color: #fff;
    background-color: rgba(44, 62, 80, 0.3);
}
.teikei-tab-button.active {
    color: #f0e6d2;
    background-color: var(--theme-bg-main, #1a2c6d);
    border-color: var(--theme-border, #2a3c7d);
    border-bottom-color: var(--theme-bg-main, #1a2c6d);
    margin-bottom: -2px;
}
.teikei-tab-content-wrapper {
    padding: 0;
}
.teikei-tab-content {
    display: none;
}
.teikei-tab-content.active {
    display: block;
}

/* スマホ向けアコーディオンUI */
.teikei-accordion-item {
    margin-bottom: 10px;
    border: 1px solid var(--theme-border, #2a3c7d);
    border-radius: 8px;
    background-color: var(--theme-bg-dark, #0d1a50);
}
.teikei-accordion-summary {
    display: block;
    cursor: pointer;
    padding: 15px;
    color: #c8a464;
    font-weight: bold;
    list-style: none;
    position: relative;
}
.teikei-accordion-summary::-webkit-details-marker { display: none; }
.teikei-accordion-summary h3 {
    margin: 0;
    font-size: 1.1em;
    display: inline-block;
}
.teikei-accordion-summary::before {
    content: '▶';
    position: absolute;
    right: 15px;
    top: 50%;
    transform: translateY(-50%);
    transition: transform 0.2s ease;
    color: #c8a464;
}
.teikei-accordion-item[open] > .teikei-accordion-summary::before {
    transform: translateY(-50%) rotate(90deg);
}
.teikei-accordion-content {
    padding: 10px 15px 15px;
    border-top: 1px solid var(--theme-border, #2a3c7d);
}

/* レスポンシブ表示切り替え */
@media (max-width: 768px) {
    #teikei-list-container .teikei-tab-nav,
    #teikei-list-container .teikei-tab-content-wrapper {
        display: none;
    }
}
@media (min-width: 769px) {
    #teikei-list-container .teikei-accordion-item {
        display: none;
    }
}

/* 定型文アイテムと選択肢ボタンのスタイル */
.teikei-item-container {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 10px;
    margin-bottom: 8px;
    padding: 8px;
    background-color: var(--theme-bg-main, #1a2c6d);
    border-radius: 5px;
    border: 1px solid var(--theme-border, #2a3c7d);
}
.teikei-item-container .teikei-btn {
    background-color: var(--button-bg, #3498db);
    color: var(--button-color, #FFFFFF);
    border: none;
    padding: 8px 12px;
    border-radius: 5px;
    cursor: pointer;
    font-weight: bold;
    flex-shrink: 0;
}
.teikei-item-container .teikei-btn:hover {
    background-color: var(--button-hover-bg, #2980b9);
}
.teikei-options {
    display: flex;
    flex-wrap: wrap;
    gap: 5px;
    flex-grow: 1;
}
.teikei-option-btn {
    background-color: #6c757d;
    color: white;
    border: 1px solid #5a6268;
    border-radius: 5px;
    padding: 5px 10px;
    cursor: pointer;
    font-weight: normal;
    font-size: 0.9em;
    white-space: nowrap;
}
.teikei-option-btn:hover {
    background-color: #5a6268;
}

/* ライトテーマ用 */
.light-theme-ui .teikei-tab-button { background-color: #ecf0f1; color: #34495e; border-color: #bdc3c7; }
.light-theme-ui .teikei-tab-button:hover { background-color: #dfe6e9; color: #2c3e50; }
.light-theme-ui .teikei-tab-button.active { background-color: #dfe6e9; color: #2c3e50; border-color: #3498db; }
.light-theme-ui .teikei-accordion-item { background-color: #ecf0f1; border-color: #bdc3c7; }
.light-theme-ui .teikei-accordion-summary { color: #2c3e50; }
.light-theme-ui .teikei-accordion-summary::before { color: #2c3e50; }
.light-theme-ui .teikei-accordion-content { border-top-color: #bdc3c7; }
.light-theme-ui .teikei-item-container { background-color: #fff; border-color: #bdc3c7; }
.light-theme-ui .teikei-option-btn { background-color: #bdc3c7; color: #2c3e50; border-color: #a3a3a3; }
.light-theme-ui .teikei-option-btn:hover { background-color: #a3a3a3; color: #fff; }

.color-filter-btn {
    background-color: var(--theme-input-bg, #0d1a50);
    color: #bdc3c7;
    border: 1px solid var(--theme-input-border, #2a3c7d);
    border-radius: 5px;
    padding: 8px 12px;
    cursor: pointer;
    font-weight: bold;
    transition: all 0.2s ease;
    white-space: nowrap;
}

.color-filter-btn:hover {
    background-color: var(--controls-panel-bg, #1a2c6d);
    color: #fff;
}

.color-filter-btn.active {
    background-color: var(--button-bg, #3498db);
    color: var(--button-color, #FFFFFF);
    border-color: var(--button-bg, #3498db);
    text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
}

.light-theme-ui .color-filter-btn {
    background-color: var(--theme-input-bg, #ecf0f1); /* ライトテーマ時のカラーフィルターボタン背景色 */
    color: #34495e;
    border-color: var(--theme-input-border, #bdc3c7); /* ライトテーマ時のカラーフィルターボタンボーダー色 */
}

.light-theme-ui .color-filter-btn:hover {
    background-color: #dfe6e9;
    color: #2c3e50;
}

.light-theme-ui .color-filter-btn.active {
    background-color: #3498db;
    color: #fff;
    border-color: #3498db;
}

/* カスタムアラート/確認モーダル用スタイル */
.custom-modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1001; /* 既存のモーダルより高く */
    opacity: 1;
    transition: opacity 0.3s ease;
}

.custom-modal-content {
    background-color: var(--theme-bg-main, #1a2c6d);
    padding: 30px;
    border-radius: 10px;
    width: 90%;
    max-width: 400px;
    box-shadow: 0 5px 25px rgba(0,0,0,0.5);
    border: 1px solid var(--theme-border, #2a3c7d);
    color: #f0e6d2;
    text-align: center;
    transform: scale(1);
    transition: transform 0.3s ease;
}

.custom-modal-content p {
    margin-bottom: 20px;
    font-size: 1.1em;
    line-height: 1.5;
}

.custom-modal-actions {
    display: flex;
    justify-content: center;
    gap: 15px;
    margin-top: 20px;
}

.custom-modal-actions .primary-button,
.custom-modal-actions .secondary-button {
    padding: 10px 20px;
    border-radius: 5px;
    cursor: pointer;
    font-weight: bold;
    transition: all 0.2s ease;
}

.custom-modal-actions .primary-button {
    background: var(--button-bg, #3498db);
    color: var(--button-color, #FFFFFF);
    border: none;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.4);
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}

.custom-modal-actions .primary-button:hover {
    background: var(--button-hover-bg, #2980b9);
    transform: translateY(-1px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.3);
}

.custom-modal-actions .secondary-button {
    background-color: #6c757d;
    color: white;
    border: 1px solid #5a6268;
}

.custom-modal-actions .secondary-button:hover {
    background-color: #5a6268;
}

/* ライトテーマ用 */
.light-theme-ui .custom-modal-content {
    background-color: #ecf0f1;
    border-color: #bdc3c7;
    color: #2c3e50;
}

.light-theme-ui .custom-modal-actions .primary-button {
    background: #3498db;
    color: #FFFFFF;
}

.light-theme-ui .custom-modal-actions .primary-button:hover {
    background: #2980b9;
}

.light-theme-ui .custom-modal-actions .secondary-button {
    background-color: #bdc3c7;
    color: #2c3e50;
    border-color: #a3a3a3;
}

.light-theme-ui .custom-modal-actions .secondary-button:hover {
    background-color: #a3a3a3;
    color: #fff;
}